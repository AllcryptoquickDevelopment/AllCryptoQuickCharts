<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proxy Super in JS y HTML</title>
</head>
<body>
    
</body>
<script>
    const food = proxy_food()
    function proxy_food() {
        let all_in = {
            // correct pattern
            fruits: ["apple","pear"],
            fruits_count: NaN,

            // incorrect pattern
            veggies: ["corn","spinach","squash"],
            veggies_count: 3
        }
        let fn = {
            // using gets for virtual props is correct
            get: (obj = all_in, prop, proxy) => {
                if(prop === "fruits_count") return obj.fruits.length

                return obj[prop]
            },

            // using sets for virtual props is incorrect.
            set: (obj = all_in, prop, value) => {
                // checks
                if(prop === "veggies_count") throw "Property, veggies_count is readonly."
                
                // default/catch-all set
                obj[prop] = value

                // this set fails silently!! 
                // it can't work since we disallow sets above!
                if(prop === "veggies") obj.veggies_count = obj.veggies.length
            }
        }
        all_in = new Proxy(all_in, fn)
        return all_in
    }

    const snack = proxy_snack()
    function proxy_snack() {
        let all_in = {
            snacks: ["yums", "juicebox", "tasties"],
            snack_list: "",
            first_snack: "",
            snack_count: NaN
        }
        let fn = {
            get: (obj = all_in, prop, proxy) => {
                switch (prop) {
                    case "snack_list": return obj.snacks.join(", ")
                    case "first_snack": return obj.snacks[0]
                    case "snack_count": return obj.snacks.length
                }
                return obj[prop]
            },
            set: (obj, prop, value) => {}
        }
        all_in = new Proxy(all_in, fn)
        return all_in
    }

    const meal = proxy_meal()
    function proxy_meal() {
        let all_in = {
            burger: { value: "cheeseburger", cheese: true },
            sandwhich: { value: "ham sandwhich", cheese: true },
            salad: { value: "caesar salad", cheese: false }
        }
        const fn = {
            get: (obj = all_in, prop = "") => {
                console.log(obj[prop])
                // console.log(obj[prop], prop, proxy)
                // if(obj[prop].value) return 
                return obj[prop]
            },
            // set: (obj = all_in, prop, value) => {}
        }
        all_in = new Proxy(all_in, fn)
        return all_in
    }
    
</script>
</html>